# Очищаем данные в правильном порядке (от зависимых к родителям)
ClassSoftware.delete_all
CompClass.delete_all
InstalledSoftware.delete_all
Cafedra.delete_all
Faculty.delete_all
User.delete_all

puts "Создание ролей и супер-админа"
%w[admin moderator].each do |r|
  Role.find_or_create_by!(name: r)
end

admin_role = Role.find_by!(name: 'admin')
User.find_or_create_by!(email: 'admin@example.com') do |u|
  u.username              = 'superadmin'
  u.password              = 'changeme123'
  u.password_confirmation = 'changeme123'
  u.role                  = admin_role
end

puts "Данные для admin\n"
puts "username: superadmin"
puts "email: admin@example.com"
puts "password: changeme123"


puts "Создание факультетов..."
faculties = [
  ['Авиа', 'Авиастроение'],
  ['АМиУ', 'Автоматизация, мехатроника и управление'],
  ['АП', 'Агропромышленный'],
  ['БЖиИЭ', 'Безопасность жизнедеятельности и инженерная экология'],
  ['БиоВедМед', 'Биоинженерия и ветеринарная медицина'],
  ['ДТ', 'Дорожно-транспортный'],
  ['ИБиМ', 'Иновационный бизнес и менеджмент'],
  ['ИиВТ', 'Информатика и Вычислительная Техника'],
  ['ИС', 'Инженерно-строительный'],
  ['ИФКиС', 'Институт Физической культуры и спорта'],
  ['М', 'Международный'],
  ['Маг', 'Отдел магистратуры'],
  ['МКиМТ', 'Медиакоммуникации и мультимедийные технологии'],
  ['МТиО', 'Машиностроительные технологии и оборудование'],
  ['ПГС', 'Промышленное и гражданское строительство'],
  ['ПиТР', 'Приборостроение и техническое регулирование'],
  ['ППД', 'Психология, педагогика и дефектология'],
  ['СГ', 'Социально-гуманитарный'],
  ['СТ', 'Сервис и туризм'],
  ['ТМ', 'Технология машиностроения'],
  ['ТСиЭ', 'Транспорт, сервис и эксплуатация'],
  ['УВОиПВО', 'Военный факультет'],
  ['ШАДИ', 'Школа архитектуры, дизайна и искусств'],
  ['ЭиНГП', 'Энергетика и нефтегазопромышленность'],
  ['Ю', 'Юридический']
]

faculties.each do |short, full|
  Faculty.find_or_create_by!(name: short, description: full)
end

puts "Создание кафедр..."
cafedras_data = [
  ['ТФиХОМ', 'Технологии формообразования и художественная обработка материалов', 'МТиО'],
  ['АПП', 'Автоматизация производственных процессов', 'АМиУ'],
  ['ИиКГ', 'Инженерная и компьютерная графика', 'АП'],
  ['ГГиТП', 'Гидравлика, гидропневмоавтоматика и тепловые процессы', 'АМиУ'],
  ['ЕН', 'Естественные науки', 'М'],
  ['МиИЭ', 'Маркетинг и инженерная экономика', 'ИБиМ'],
  ['НТПиПК', 'Научно-технический перевод и профессиональная коммуникация', 'СГ'],
  ['ИТ', 'Информационные технологии', 'ИиВТ'],
  ['ИиК', 'История и культурология', 'МКиМТ'],
  ['МиАСП', 'Машины и автоматизация сварочного производства', 'МТиО'],
  ['КиПП', 'Коммерческое и предпринимательское право', 'Ю'],
  ['ОП', 'Основы правоведения', 'Ю'],
  ['ТТПП', 'Техника и технологии пищевых производств', 'АП'],
  ['МРСиИ', 'Металлорежущие станки и инструменты', 'ТМ'],
  ['ОКМ', 'Основы конструирования машин', 'ТМ'],
  ['ЭМ', 'Экономика и менеджмент', 'ИБиМ'],
  ['БЖиЗОС', 'Безопасность жизнедеятельности и защита окружающей среды', 'БЖиИЭ'],
  ['ПОВТиАС', 'Программное обеспечение вычислительной техники и автоматизированных систем', 'ИиВТ'],
  ['ПИ', 'Педагогические измерения', 'ППД'],
  ['ФВ', 'Физвоспитание', 'ИФКиС']
]

cafedras_data.each do |abbr, full_name, faculty_code|
  faculty = Faculty.find_by(name: faculty_code)

  if faculty
    Cafedra.find_or_create_by!(
      name: abbr,
      description: full_name,
      faculty_id: faculty.id
    )
  else
    puts "⚠️ Факультет '#{faculty_code}' не найден для кафедры '#{abbr}'"
  end
end

puts "✅ Данные успешно загружены!"
